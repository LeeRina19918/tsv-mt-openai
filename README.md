# TSV-MT-OPENAI (Azure Translator) — машинний переклад TSV локалізації

Цей репозиторій автоматично перекладає **TSV-файл локалізації гри**: бере текст із колонки `source`, надсилає в **Azure AI Translator (Text Translation)**, і записує результат у колонку `translation`. Готовий файл з’являється в папці `output/`.

## Що потрібно перед стартом

* Обліковий запис **Microsoft Azure**
* Створений ресурс **Azure AI Translator (Text Translation)** на тарифі **Free (F0)** (щоб було безкоштовно в межах квоти)
* Ваші дані доступу: **Key**, **Region**, **Endpoint**
* Файл локалізації у форматі **TSV** з колонками (заголовок має бути обов’язково):

  * `id`
  * `flags`
  * `source`
  * `translation`

> Важливо: безкоштовний F0 має обмеження на кількість символів/запитів у період. Якщо квота закінчиться — переклад може зупинятись або відповідати помилками (часто 429).

---

# 1) Створити безкоштовний Azure Translator (F0)

1. Увійдіть в Azure Portal.
2. Створіть ресурс перекладу:

   * **Create a resource** → пошук: **Translator** / **Text Translation**
3. При створенні:

   * **Pricing tier**: оберіть **F0 (Free)**
   * **Region**: оберіть будь-який доступний (наприклад `westeurope`)
   * Назви (Name/Resource group) — довільні (наприклад `tran-game-uk`)
4. Після створення відкрийте ресурс і знайдіть:

   * **Keys and Endpoint** (або розділ **Keys**)
   * Збережіть:

     * **KEY1** (або KEY2)
     * **Region**
     * **Endpoint**

> Якщо не бачите “Keys and Endpoint”: переконайтесь, що ви відкрили **сам ресурс перекладача**, а не resource group. У лівому меню зазвичай є пункт **Keys and Endpoint** / **Keys**.

---

# 2) Налаштувати `.env` (обов’язково)

У корені репозиторію створіть файл `.env` (або відредагуйте, якщо він вже створений у Codespaces) і вставте туди ваші значення:

```env
AZURE_TRANSLATOR_KEY=ВАШ_КЛЮЧ
AZURE_TRANSLATOR_REGION=ВАША_РЕГІЯ (наприклад westeurope)
AZURE_TRANSLATOR_ENDPOINT=ВАШ_ENDPOINT
```

## Який Endpoint правильний

Є два варіанти endpoint’а. Використовуйте **той, який у вас показує Azure** в “Keys and Endpoint”.

Найчастіше робочий варіант для ресурсного endpoint:

```env
AZURE_TRANSLATOR_ENDPOINT=https://<ваш-ресурс>.cognitiveservices.azure.com/translator/text/v3.0
```

> Без `.env` переклад не запуститься. Це нормально: кожен користувач підв’язує **свій** Azure.

---

# 3) Завантажити TSV у `input/`

1. Покладіть ваш файл у папку `input/`
   Наприклад: `input/uk.tsv`

---

# 4) Запустити переклад

## Переклад одного файлу

```bash
bash run_translate.sh input/uk.tsv
```

Після завершення результат буде тут:

* `output/uk.uk.tsv` (назва формується автоматично)

## Де шукати результат

Відкрийте папку `output/` у файловому дереві Codespaces або перевірте командою:

---

# 5) Скільки часу це займає (орієнтовно)

Час залежить від:

* кількості рядків із текстом у `source`
* пауз між батчами (щоб не ловити 429)
* стабільності мережі та ліміту F0

## Орієнтовні діапазони часу (типові)

Це приблизні оцінки для обережного режиму з паузами і можливими 429:

* **1 000 рядків**: ~ **5–15 хв**
* **5 000 рядків**: ~ **25–60 хв**
* **10 000 рядків**: ~ **45–120 хв**
* **20 000 рядків**: ~ **1.5–4 години**

> Якщо в процесі “довго нічого не відбувається” — це може бути нормальна пауза між батчами або очікування після 429.

---

## `Connection refused` або мережеві помилки

* інколи проблема в мережі Codespaces/проксі або доступі до домену
* спробуйте перезапустити Codespace або повторити запуск пізніше

---

# Безпека

* **Ніколи не комітьте** `.env` з ключами в репозиторій.
* Переконайтесь, що `.gitignore` містить рядок:

  ```
  .env
  ```
